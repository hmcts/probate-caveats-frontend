{% extends "includes/two_thirds_form.html" %}

{% from "govuk/components/fieldset/macro.njk" import govukFieldset %}
{% from "govuk/components/input/macro.njk" import govukInput %}
{% from "govuk/components/button/macro.njk" import govukButton %}
{% from "widgets/addresslookup.html" import addressFinder %}

{% block form_content %}
    {% call govukFieldset({
        legend: {
            text: content.question | safe,
            classes: "govuk-fieldset__legend--l",
            isPageHeading: true
        }
    }) %}
        <p class="govuk-hint">{{ content.explanation1 | safe }}</p>
        {{ addressFinder(
            fields,
            content,
            globals.basePath,
            "ApplicantAddress"
        ) }}
    {% endcall %}

    {% call govukFieldset({
        legend: {
            text: content.enterManually,
            classes: "govuk-visually-hidden"
        }
    }) %}
        <details class="govuk-details" id="details-panel" {{ "open" if (
            fields.addressLine1.value or
            fields.addressLine2.value or
            fields.addressLine3.value or
            fields.postTown.value or
            fields.newPostCode.value or
            fields.country.value or
            fields.addressLine1.errorMessage or
            fields.postTown.errorMessage or
            fields.newPostCode.errorMessage
        ) }}>
            <summary class="govuk-details__summary">
                <span class="govuk-details__summary-text">{{ content.enterManually }}</span>
            </summary>
            <div class="govuk-details__text">
                {{ govukInput({
                    label: {
                        text: content.addressLabel
                    },
                    id: "addressLine1",
                    name: "addressLine1",
                    value: fields.addressLine1.value | safe,
                    errorMessage: { text: fields.addressLine1.errorMessage.message } if fields.addressLine1.errorMessage,
                    attributes: {
                        maxlength: 150
                    },
                    classes: "govuk-!-width-three-quarters"
                }) }}
                {{ govukInput({
                    label: {
                        text: content.addressLabel2,
                        classes: "govuk-visually-hidden"
                    },
                    id: "addressLine2",
                    name: "addressLine2",
                    value: fields.addressLine2.value | safe,
                    attributes: {
                        maxlength: 50
                    },
                    classes: "govuk-!-width-three-quarters"
                }) }}
                {{ govukInput({
                    label: {
                        text: content.addressLabel3,
                        classes: "govuk-visually-hidden"
                    },
                    id: "addressLine3",
                    name: "addressLine3",
                    value: fields.addressLine3.value | safe,
                    attributes: {
                        maxlength: 50
                    },
                    classes: "govuk-!-width-three-quarters"
                }) }}
                {{ govukInput({
                    label: {
                        text: content.postTown
                    },
                    id: "postTown",
                    name: "postTown",
                    value: fields.postTown.value | safe,
                    errorMessage: { text: fields.postTown.errorMessage.message } if fields.postTown.errorMessage,
                    attributes: {
                        maxlength: 50
                    },
                    classes: "govuk-!-width-three-quarters"
                }) }}
                {{ govukInput({
                    label: {
                        text: content.postcode
                    },
                    id: "newPostCode",
                    name: "newPostCode",
                    value: fields.newPostCode.value | safe,
                    errorMessage: { text: fields.newPostCode.errorMessage.message } if fields.newPostCode.errorMessage,
                    attributes: {
                        maxlength: 14
                    },
                    classes: "govuk-!-width-one-quarter"
                }) }}
                {{ govukInput({
                    label: {
                        text: content.country
                    },
                    id: "country",
                    name: "country",
                    value: fields.country.value | safe,
                    attributes: {
                        maxlength: 50
                    },
                    classes: "govuk-!-width-three-quarters"
                }) }}
            </div>
        </details>

        <div class="govuk-form-group">
            {{ govukButton({
                text: common.saveAndContinue,
                preventDoubleClick: true,
                attributes: {
                    id: "submitAddress"
                }
            }) }}
        </div>
    {% endcall %}

    <script src="/public/javascripts/addressFieldset.js"></script>
{% endblock %}
